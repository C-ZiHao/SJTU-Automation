clc;
clear;
hold on

deg = pi/180;
L(1) = Revolute('d', 0, 'a', 0, 'alpha', pi/2, ...
    'I', [0, 0.35, 0, 0, 0, 0], ...
    'r', [0, 0, 0], ...
    'm', 0, ...
    'Jm', 200e-6, ...
    'G', -62.6111, ...
    'B', 1.48e-3, ...
    'Tc', [0.395 -0.435], ...
    'qlim', [-90 90]*deg );

L(2) = Revolute('d', 0, 'a', 100, 'alpha', 0, ...
    'I', [0.13, 0.524, 0.539, 0, 0, 0], ...
    'r', [-0.3638, 0.006, 0.2275], ...
    'm', 17.4, ...
    'Jm', 200e-6, ...
    'G', 107.815, ...
    'B', .817e-3, ...
    'Tc', [0.126 -0.071], ...
    'qlim', [-90 90]*deg );

L(3) = Revolute('d', 20, 'a', 10, 'alpha', -pi/2,  ...
    'I', [0.066, 0.086, 0.0125, 0, 0, 0], ...
    'r', [-0.0203, -0.0141, 0.070], ...
    'm', 4.8, ...
    'Jm', 200e-6, ...
    'G', -53.7063, ...
    'B', 1.38e-3, ...
    'Tc', [0.132, -0.105], ...
    'qlim', [-90 90]*deg );

L(4) = Revolute('d', 100, 'a', 0, 'alpha', pi/2,  ...
    'I', [1.8e-3, 1.3e-3, 1.8e-3, 0, 0, 0], ...
    'r', [0, 0.019, 0], ...
    'm', 0.82, ...
    'Jm', 33e-6, ...
    'G', 76.0364, ...
    'B', 71.2e-6, ...
    'Tc', [11.2e-3, -16.9e-3], ...
    'qlim', [-90 90]*deg);

L(5) = Revolute('d', 0, 'a', 0, 'alpha', -pi/2,  ...
    'I', [0.3e-3, 0.4e-3, 0.3e-3, 0, 0, 0], ...
    'r', [0, 0, 0], ...
    'm', 0.34, ...
    'Jm', 33e-6, ...
    'G', 71.923, ...
    'B', 82.6e-6, ...
    'Tc', [9.26e-3, -14.5e-3], ...
    'qlim', [-90 90]*deg );


L(6) = Revolute('d', 0, 'a', 0, 'alpha', 0,  ...
    'I', [0.15e-3, 0.15e-3, 0.04e-3, 0, 0, 0], ...
    'r', [0, 0, 0.032], ...
    'm', 0.09, ...
    'Jm', 33e-6, ...
    'G', 76.686, ...
    'B', 36.7e-6, ...
    'Tc', [3.96e-3, -10.5e-3], ...
    'qlim', [-90 90]*deg );

p560 = SerialLink(L,'name','p560');

p560.base = transl(-50,0,0);

%%Draw the boundary of the obscale
plot3([0,200],[-15,-15],[125,125],'k')
plot3([0,200],[15,15],[125,125],'k')
plot3([0,200],[-15,-15],[-25,-25],'k')
plot3([0,200],[15,15],[-25,-25],'k')
plot3([0,0],[-15,-15],[125,-25],'k')
plot3([0,0],[15,15],[125,-25],'k')
plot3([200,200],[-15,-15],[125,-25],'k')
plot3([200,200],[15,15],[125,-25],'k')
plot3([0,0],[-15,15],[125,125],'k')
plot3([200,200],[-15,15],[125,125],'k')
plot3([0,0],[-15,15],[-25,-25],'k')
plot3([200,200],[-15,15],[-25,-25],'k')

%%Define the intial position & the target position
pini = [100 100 10].';
pend = [100 -100 10].';
Ti = transl(pini);
Te = transl(pend);
qi = p560.ikine6s(Ti,'ru');
% p560.plot(qi);

%%Trajectories
pmid1 = [0,50,150].';
Tm1 = transl(pmid1);
qm = p560.ikine6s(Tm1,'ru');
% p560.plot(qm);
t = [0:0.05:2]';
q1 = p560.jtraj(Ti, Tm1, t);
p560.plot(q1)

pmid2 = [0,-50,150].';
Tm2 = transl(pmid2);
qm = p560.ikine6s(Tm2,'ru');
% p560.plot(qm);
t = [0:0.05:2]';
q2 = p560.jtraj(Tm1, Tm2, t);
p560.plot(q2)

t = [0:0.05:2]';
q3 = p560.jtraj(Tm2, Te, t);
p560.plot(q3)